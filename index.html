<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visual Editor</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <!-- Welcome Modal -->
  <div class="modal-overlay show" id="welcomeModal">
    <div class="modal" style="max-width: 900px;">
      <div class="modal-header">
        <h2>Create New Project</h2>
      </div>
      <div class="modal-body">
        <p style="text-align: center; margin-bottom: 30px; color: #666;">Choose what type of content you want to create:</p>
        <div class="type-selector">
          <div class="type-card" onclick="selectContentType('presentation')">
            <div class="type-icon"><i class="fas fa-play-circle"></i></div>
            <h3>Presentation</h3>
            <p>16:9 slides with title, content, charts & diagrams</p>
          </div>
          <div class="type-card" onclick="selectContentType('website')">
            <div class="type-icon"><i class="fas fa-globe"></i></div>
            <h3>Website</h3>
            <p>Long scrolling sections for landing pages</p>
          </div>
          <div class="type-card" onclick="selectContentType('resume')">
            <div class="type-icon"><i class="fas fa-file-alt"></i></div>
            <h3>Resume</h3>
            <p>A4 professional documents & CVs</p>
          </div>
          <div class="type-card" onclick="selectContentType('post')">
            <div class="type-icon"><i class="fas fa-share-alt"></i></div>
            <h3>Social Post</h3>
            <p>Social media images & carousels</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toolbar -->
  <div class="toolbar" id="mainToolbar" style="display: none;">
    <div class="toolbar-left">
      <div class="logo" onclick="showNewProjectModal()"><i class="fas fa-plus"></i> New Project</div>
      <div class="toolbar-divider"></div>
      <div class="current-type-badge" id="currentTypeBadge">
        <i class="fas fa-play-circle"></i> Presentation
      </div>
    </div>
    <div class="toolbar-center">
      <div class="toolbar-group" id="presentation-controls">
        <button class="btn" onclick="addNewItem()"><i class="fas fa-plus"></i> Add Slide</button>
        <button class="btn" onclick="duplicateItem()"><i class="fas fa-copy"></i></button>
        <button class="btn" onclick="deleteItem()" style="color: #ef4444;"><i class="fas fa-trash"></i></button>
      </div>
      <div class="toolbar-group" id="website-controls" style="display: none;">
        <button class="btn" onclick="addWebsiteSection()"><i class="fas fa-plus"></i> Add Section</button>
      </div>
      <div class="toolbar-group" id="resume-controls" style="display: none;">
        <button class="btn" onclick="addResumeSection()"><i class="fas fa-plus"></i> Add Section</button>
        <button class="btn" onclick="addResumePage()"><i class="fas fa-file"></i> New Page</button>
      </div>
      <div class="toolbar-group" id="post-controls" style="display: none;">
        <button class="btn" onclick="addPost()"><i class="fas fa-plus"></i> New Post</button>
      </div>
    </div>
    <div class="toolbar-right">
      <button class="btn" onclick="undo()" title="Undo (Ctrl+Z)"><i class="fas fa-undo"></i></button>
      <button class="btn" onclick="redo()" title="Redo (Ctrl+Y)"><i class="fas fa-redo"></i></button>
      <div class="toolbar-divider"></div>
      <button class="btn" onclick="showThemeModal()"><i class="fas fa-palette"></i> Theme</button>
      <button class="btn" onclick="saveProject()"><i class="fas fa-save"></i> Save</button>
      <button class="btn" onclick="loadProject()"><i class="fas fa-folder-open"></i> Load</button>
      <button class="btn" onclick="showLayoutLibrary()"><i class="fas fa-th-large"></i> Layouts</button>
      <button class="btn btn-primary" onclick="showExportModal()"><i class="fas fa-download"></i> Export</button>
    </div>
  </div>

  <div class="main-container" id="mainContainer" style="display: none;">
    <div class="sidebar">
      <div class="sidebar-header" id="sidebarHeader">Slides</div>
      <div class="sidebar-content">
        <div class="items-list" id="itemsList"></div>
        <button class="add-item-btn" onclick="addNewItem()">
          <span>+</span> <span id="addButtonText">Add Slide</span>
        </button>
      </div>
    </div>

    <div class="canvas-container">
      <div class="canvas-toolbar">
        <div class="zoom-controls">
          <button class="btn btn-icon" onclick="zoomOut()">−</button>
          <span class="zoom-level" id="zoomLevel">100%</span>
          <button class="btn btn-icon" onclick="zoomIn()">+</button>
        </div>
        <div class="item-nav">
          <button class="btn btn-icon" onclick="prevItem()">←</button>
          <span id="itemCounter">0 / 0</span>
          <button class="btn btn-icon" onclick="nextItem()">→</button>
        </div>
      </div>
      <div class="canvas-area" id="canvasArea">
        <div class="empty-canvas" id="emptyCanvas">
          <div class="empty-state">
            <i class="fas fa-plus-circle"></i>
            <h2>Get Started</h2>
            <p id="emptyMessage">Add your first item</p>
            <button class="btn btn-primary" onclick="addNewItem()">
              <i class="fas fa-plus"></i> Add Item
            </button>
          </div>
        </div>
        <div class="item-wrapper" id="itemWrapper" style="display: none;">
          <div class="item-content" id="currentItem"></div>
        </div>
      </div>
    </div>

    <div class="properties-panel">
      <div class="property-section">
        <h3>Settings</h3>
        <div class="property-group">
          <label>Layout</label>
          <select id="layoutSelect" onchange="changeLayout(this.value)">
            <option value="">Select layout...</option>
          </select>
        </div>
        <div class="property-group" id="animationGroup">
          <label>Animation</label>
          <select id="animationSelect" onchange="changeAnimation(this.value)">
            <option value="none">None</option>
            <option value="fade">Fade</option>
            <option value="slide-up">Slide Up</option>
            <option value="slide-left">Slide Left</option>
            <option value="zoom">Zoom</option>
          </select>
        </div>
        <div class="action-buttons">
          <button class="btn" onclick="duplicateItem()">Duplicate</button>
          <button class="btn" style="background: var(--danger);" onclick="deleteItem()">Delete</button>
        </div>
      </div>
      <div class="property-section" id="fieldsSection">
        <h3>Content</h3>
        <div id="fieldsContainer"></div>
      </div>
      <div class="property-section">
        <h3>Colors</h3>
        <div class="color-row">
          <div class="property-group">
            <label>Background</label>
            <input type="color" id="bgColor" onchange="updateColor('bg', this.value)">
          </div>
          <div class="property-group">
            <label>Text</label>
            <input type="color" id="textColor" onchange="updateColor('text', this.value)">
          </div>
        </div>
        <div class="color-row">
          <div class="property-group">
            <label>Primary</label>
            <input type="color" id="primaryColor" onchange="updateColor('primary', this.value)">
          </div>
          <div class="property-group">
            <label>Secondary</label>
            <input type="color" id="secondaryColor" onchange="updateColor('secondary', this.value)">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Layout Library Modal -->
  <div class="modal-overlay" id="layoutLibraryModal">
    <div class="modal" style="max-width: 1000px;">
      <div class="modal-header">
        <h2 id="layoutLibraryTitle">Layouts</h2>
        <button class="btn btn-icon" onclick="hideLayoutLibrary()">✕</button>
      </div>
      <div class="modal-body">
        <div class="layout-categories" id="layoutCategories"></div>
        <div class="layout-grid" id="layoutGrid"></div>
      </div>
    </div>
  </div>

  <!-- Theme Modal -->
  <div class="modal-overlay" id="themeModal">
    <div class="modal">
      <div class="modal-header">
        <h2>Choose Theme</h2>
        <button class="btn btn-icon" onclick="hideThemeModal()">✕</button>
      </div>
      <div class="modal-body">
        <div class="theme-grid" id="themeGrid"></div>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div class="modal-overlay" id="exportModal">
    <div class="modal">
      <div class="modal-header">
        <h2>Export</h2>
        <button class="btn btn-icon" onclick="hideExportModal()">✕</button>
      </div>
      <div class="modal-body">
        <div class="property-group">
          <label>Format</label>
          <select id="exportFormat"></select>
        </div>
        <div class="action-buttons" style="margin-top: 20px;">
          <button class="btn btn-primary" style="flex: 1;" onclick="doExport()">Export</button>
        </div>
      </div>
    </div>
  </div>

  <!-- File Input for Loading -->
  <input type="file" id="loadFileInput" accept=".json" style="display: none;" onchange="handleFileLoad(event)">

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script src="config.js"></script>
  <script src="editor.js"></script>
</body>
</html>
